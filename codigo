import java.util.Scanner;

public class Main {
    // Variáveis declaradas !fora do main! como variáveis do escopo da classe
    static int[] ids;
    static String[] nomes;
    static double[] precos;
    static int[] estoques;
    static boolean baseInicializada = false;
    
    static int[] vendaIds = new int[1000];
    static int[] vendaQuantidades = new int[1000];
    static int vendaCount = 0;

    public static void main(String[] args) {
        Scanner entrada = new Scanner(System.in);
        int opcao; //cria variavel para usar no switch case
        do {
            System.out.println("\n=== MacKShop ===");
            System.out.println("1. Inicializar base");
            System.out.println("2. Exibir catálogo");
            System.out.println("3. Adicionar item");
            System.out.println("4. Resumo da venda");
            System.out.println("5. processo");
            System.out.println("6. processo");
            System.out.println("7. processo");
            System.out.println("8. processo");
            System.out.println("9. processo");
            System.out.println("0. Sair");
            System.out.print("Escolha uma opção: ");
            opcao = entrada.nextInt();

            switch (opcao) {
                case 1:
                    inicializarBase();
                    break;
                case 2:
                    exibirCatalogo();
                    break;
                case 3:
                    addItemVenda();
                    break;
                case 4:
                    resumoVendaAtual();
                    break;
                case 5:
                    //finalizarVenda();
                    break;
                case 6:
                    //historiicoVendas();
                    break;
                case 7:
                    //buscarHistorico();
                    break;
                case 8:
                    //reporEstoque();           //somente admin
                    break;
                case 9:
                    //relatorioEstoqueBaixo();  //somenre admin
                    break;
                default:
                    System.out.println("Opção inválida!");
            }
        } while (opcao > 0); {    //isso ta meio escroto, tem q arrumar
            System.out.println("Fim!");
        };

        entrada.close();
    }

    public static void inicializarBase() {
        ids = new int[] {101, 102, 103, 104, 105};
        nomes = new String[] {"Mouse", "Teclado", "Headset", "Mouse Pad", "Monitor", "Chinelo"};
        precos = new double[] {150.0, 350.0, 420.5, 90.0, 1500.0, 31.5};
        estoques = new int[]  {21, 12, 17, 42, 4, 0};

        baseInicializada = true; //obs: o programa só vai funcionar se baseInicializada = true, por isso esta aqui
        System.out.println("\nBase inicializada com sucesso!\nUse o programa a vontade!");
    }

    //métdo catálogo
    public static void exibirCatalogo() {
        if (!baseInicializada) {
            System.out.println("Erro: Execute primeiro a opção 1 - Inicializar base!");
            return;
        }

        System.out.println("\nCatálogo de Produtos");

        //esse "for" vai percorrer nossas listas e printar cada elemento na ordem correta
        for (int i = 0; i < ids.length; i++) {
            if (estoques[i] > 0) {
                System.out.printf("ID: %d | Nome: %s | Preço: R$ %.2f | Estoque: %d\n",
                        ids[i], nomes[i], precos[i], estoques[i]);
            }
        }
    }
    
    public static void addItemVenda() {
        if (baseInicializada == false) {
            System.out.println("Erro: Execute primeiro a opção 1 - Inicializar base!");
            return;
        }

        Scanner entrada = new Scanner(System.in);

        System.out.print("Digite o ID do produto: ");
        int id = entrada.nextInt();

        // procurar produto
        int indice = -1;
        for (int i = 0; i < ids.length; i++) {
            if (ids[i] == id) {
                indice = i;
                break;
            }
        }

        if (indice == -1) {
            System.out.println("Produto não encontrado!");
            return;
        }

        System.out.print("Digite a quantidade: ");
        int qtd = entrada.nextInt();

        if (qtd <= 0) {
            System.out.println("Quantidade inválida!");
            return;
        }

        if (qtd > estoques[indice]) {
            System.out.println("Estoque insuficiente! Disponível: " + estoques[indice]);
            return;
        }

        // registrar na venda
        vendaIds[vendaCount] = ids[indice];
        vendaQuantidades[vendaCount] = qtd;
        vendaCount++;

        // diminuir estoque
        estoques[indice] -= qtd;

        System.out.printf("Produto %s adicionado à venda (Qtd: %d)\n", nomes[indice], qtd);
    }

    public static int procurarIndiceId(int id) { //essa função serve pra buscar o id de um item e verificar se existe dentro da lista ids[], retornando o index
        for (int i = 0; i < ids.length; i++){  
            if (ids[i] == id) {
                return i;
            }
        }
        return -1; //caso não ache o item, retorna o index como -1, pq ele não existe
    } 

    public static void resumoVendaAtual() { //percorre os itens que foram comprados e mostra qntd, total e estoque
        if (!baseInicializada) {
            System.out.println("Erro: Execute primeiro a opção 1 - Inicializar base!");
            return;
        }
        if (vendaCount == 0) {
            System.out.println("Nenhum item adicionado à venda ainda.");
            return;
        }

        System.out.println("=== Resumo da Venda Atual ===");
        double total = 0.0;

        for (int i = 0; i < vendaCount; i++) {
            int id = vendaIds[i];
            int qtd = vendaQuantidades[i];
            int index = procurarIndiceId(id);

            if (index != -1) {
                double subtotal = precos[index] * qtd; //calculo dp valor
                total += subtotal;

                System.out.printf("ID: %d | Produto: %s | Qtd: %d | Unit: R$ %.2f | Subtotal: R$ %.2f\n",
                        ids[index], nomes[index], qtd, precos[index], subtotal);
            } else {
                System.out.printf("ID: %d | Produto não encontrado no catálogo | Qtd: %d\n", id, qtd); //se o produtp nao estiver mais diponivel
            }
        }

        System.out.printf("TOTAL DA VENDA: R$ %.2f\n", total);
    }
}
